{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/OGCFeatureSource.js","../node_modules/@arcgis/core/layers/OGCFeatureLayer.js","../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js","../node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js","../node_modules/@arcgis/core/layers/graphics/sources/geojson/geojson.js","../node_modules/@babel/runtime/helpers/esm/wrapRegExp.js","../node_modules/@arcgis/core/layers/ogc/ogcFeatureUtils.js"],"names":["x","arguments","featureDefinition","type","e","this","addResolvingPromise","_loadOGCServices","layer","when","collection","t","layerDefinition","s","spatialReference","r","supportedCrs","o","apiKey","capabilities","queryParameters","customParameters","queryFeaturesJSON","then","g","fromJSON","getFeatureDefinition","load","a","isWGS84","isWebMercator","wkid","RegExp","conformsTo","some","test","components","parameters","analytics","supportsCacheHint","attachment","data","isVersioned","supportsAttachment","supportsM","supportsZ","metadata","supportsAdvancedFieldProperties","operations","supportsCalculate","supportsTruncate","supportsValidateSql","supportsAdd","supportsDelete","supportsEditing","supportsChangeTracking","supportsQuery","supportsQueryAnalytics","supportsQueryAttachments","supportsQueryTopFeatures","supportsResizeAttachments","supportsSync","supportsUpdate","supportsExceedsLimitStatistics","query","maxRecordCount","limit","schema","maximum","limitFeatures","maxRecordCountFactor","standardMaxRecordCount","supportsCentroid","supportsDisjointSpatialRelationship","supportsDistance","supportsDistinct","supportsExtent","supportsFormatPBF","supportsGeometryProperties","supportsHavingClause","supportsHistoricMoment","supportsMaxRecordCountFactor","supportsOrderBy","supportsPagination","supportsPercentileStatistics","supportsQuantization","supportsQuantizationEditMode","supportsQueryByOthers","supportsQueryGeometry","supportsResultType","supportsStandardizedQueriesOnly","supportsTopFeaturesQuery","supportsStatistics","supportsSpatialAggregationStatistics","supportedSpatialAggregationStatistics","envelope","centroid","convexHull","supportsDefaultSpatialReference","supportsCompactGeometry","supportsSqlExpression","tileMaxRecordCount","queryRelated","supportsCount","queryTopFeatures","editing","supportsDeleteByAnonymous","supportsDeleteByOthers","supportsGeometryUpdate","supportsGlobalId","supportsReturnServiceEditsInSourceSpatialReference","supportsRollbackOnFailure","supportsUpdateByAnonymous","supportsUpdateByOthers","supportsUploadWithItemId","supportsUpdateWithoutM","extent","spatial","bbox","length","p","i","xmin","ymin","xmax","ymax","zmin","zmax","h","WGS84","toJSON","storageCrs","n","u","crs","includes","filter","concat","signal","collectionId","fields","geometryType","hasZ","objectIdField","C","timeInfo","R","url","w","map","S","j","c","F","Promise","all","l","m","O","v","_conformsToType","b","collections","find","id","d","D","y","T","P","_getCapabilities","_","_getExtent","q","_getStorageSpatialReference","E","_getSupportedSpatialReferences","G","f","A","replace","prototype","constructOnly","B","V","copyright","definitionExpression","description","displayField","elevationInfo","featureReduction","fieldsIndex","fullExtent","labelingInfo","labelsVisible","legendEnabled","operationalLayerType","popupEnabled","popupTemplate","screenSizePerspectiveEnabled","source","title","typeIdField","types","destroy","loadFromPortal","supportedTypes","_fetchService","createPopupTemplate","loaded","_set","U","get","feature","attributes","domains","_getLayerDomain","queryFeatures","from","createQuery","features","forEach","sourceLayer","serviceSupportsSpatialReference","read","origin","renderer","name","domain","readOnly","json","origins","service","String","write","I","L","apiValues","reader","Boolean","enabled","ignoreOrigin","isRequired","M","symbol","JSON","stringify","Function","LineString","MultiLineString","MultiPoint","Point","Polygon","MultiPolygon","coordinates","geometry","properties","push","lengths","coords","k","code","Set","Object","keys","has","delete","add","alias","objectIdFieldName","objectIdFieldType","unknownFields","Array","_wrapRegExp","re","groups","BabelRegExp","_super","_groups","WeakMap","flags","_this","set","buildGroups","result","reduce","create","exec","str","call","Symbol","substitution","args","slice","apply","getLogger","links","href","token","headers","accept","unshift","editable","nullable","warn","message","details","field","jsonValues","startTimeField","endTimeField","trackIdField","drawingInfo","N","authority","toLowerCase","GCS_NAD_1927","Number","parseInt","isNaN","num","start","timeExtent","where","objectIds","outSpatialReference","W","Z","$","K","datetime","startindex","rel","isInteger","numberMatched","numberReturned","J","globalIdField","hasM","z","Q","objectId","H","exceededTransferLimit","globalIdFieldName","end","toISOString"],"mappings":"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","file":"static/js/84.b19eb243.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import t from\"../../../core/Error.js\";import s from\"../../../core/Loadable.js\";import{isSome as r,isNone as o}from\"../../../core/maybe.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{queryFeatureSetJSON as a,crsDefault as n,getSpatialReferenceWkid as u,getServerLandingPage as c,getServerConformance as l,getServerCollections as m,getServerOpenApi as d,getCollectionDefinition as y,crsPrefix as f}from\"../../ogc/ogcFeatureUtils.js\";import g from\"../../../rest/support/FeatureSet.js\";import h from\"../../../geometry/SpatialReference.js\";import{typeKebabDictionary as S}from\"../../../geometry/support/typeUtils.js\";let x=class extends s{constructor(){super(...arguments),this.featureDefinition=null,this.type=\"ogc-feature\"}load(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}getFeatureDefinition(){const{featureDefinition:{collection:e,layerDefinition:t,spatialReference:s,supportedCrs:r},layer:{apiKey:o,capabilities:p,customParameters:i}}=this;return{capabilities:p,collection:e,layerDefinition:t,queryParameters:{apiKey:o,customParameters:i},spatialReference:s,supportedCrs:r}}queryExtent(e,t={}){return null}queryFeatureCount(e,t={}){return null}queryFeatures(e,t={}){return this.queryFeaturesJSON(e,t).then((e=>g.fromJSON(e)))}queryFeaturesJSON(e,t={}){const s=this.getFeatureDefinition();return this.load(t).then((()=>a(s,e,t)))}queryObjectIds(e,t={}){return null}serviceSupportsSpatialReference(e){return!(!e.isWGS84&&!e.isWebMercator)||!!this.featureDefinition.supportedCrs[e.wkid]}_conformsToType(e,t){const s=new RegExp(`^${t}$`,\"i\");return e.conformsTo.some((e=>s.test(e)))??!1}_getCapabilities(e,t){const s=r(t)?t.components?.parameters:null;return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:s?.limit?.schema?.maximum??s?.limitFeatures?.schema?.maximum??5e3,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}_getExtent(e){const t=e.extent?.spatial;if(!t)return null;const s=t.bbox[0],r=4===s.length,o=s[0],p=s[1],i=r?void 0:s[2];return{xmin:o,ymin:p,xmax:r?s[2]:s[3],ymax:r?s[3]:s[4],zmin:i,zmax:r?void 0:s[5],spatialReference:h.WGS84.toJSON()}}_getStorageSpatialReference(e){const t=e.storageCrs??n,s=u(t);return o(s)?h.WGS84:new h({wkid:s})}_getSupportedSpatialReferences(e,t){const s=\"#/crs\",r=e.crs??[n],o=r.includes(s)?r.filter((e=>e!==s)).concat(t.crs):r,p=/^http:\\/\\/www\\.opengis.net\\/def\\/crs\\/epsg\\/.*\\/3785$/i;return o.filter((e=>!p.test(e)))}async _loadOGCServices(e,s){const o=r(s)?s.signal:null,{apiKey:p,collectionId:i,customParameters:a,fields:n,geometryType:g,hasZ:h,objectIdField:x,timeInfo:C,url:R}=e,w={fields:n?.map((e=>e.toJSON())),geometryType:S.toJSON(g),hasZ:h,objectIdField:x,timeInfo:C?.toJSON()},j={apiKey:p,customParameters:a,signal:o},F=await c(R,j),[O,v]=await Promise.all([l(F,j),m(F,j)]);if(!this._conformsToType(O,\"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson\"))throw new t(\"ogc-feature-layer:no-geojson-support\",\"Server does not support geojson\");const b=v.collections.find((e=>e.id===i));if(!b)throw new t(\"ogc-feature-layer:collection-not-found\",\"Server does not contain the named collection\");const D=this._conformsToType(O,\"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30\")?await d(F,j):null,T=await y(b,w,j),P=this._getCapabilities(T.hasZ,D),_=this._getExtent(b),q=this._getStorageSpatialReference(b).toJSON(),E=this._getSupportedSpatialReferences(b,v),G=new RegExp(`^${f}`,\"i\"),A={};for(const t of E){const e=u(t);r(e)&&(A[e]||(A[e]=t.replace(G,\"\")))}T.extent=_,this.featureDefinition={capabilities:P,collection:b,layerDefinition:T,queryParameters:{},spatialReference:q,supportedCrs:A}}};e([p()],x.prototype,\"featureDefinition\",void 0),e([p({constructOnly:!0})],x.prototype,\"layer\",void 0),e([p()],x.prototype,\"type\",void 0),x=e([i(\"esri.layers.graphics.sources.OGCFeatureSource\")],x);export{x as OGCFeatureSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../geometry.js\";import r from\"../PopupTemplate.js\";import\"../renderers/ClassBreaksRenderer.js\";import\"../renderers/DictionaryRenderer.js\";import\"../renderers/DotDensityRenderer.js\";import\"../renderers/HeatmapRenderer.js\";import\"../renderers/PieChartRenderer.js\";import\"../renderers/Renderer.js\";import\"../renderers/SimpleRenderer.js\";import\"../renderers/UniqueValueRenderer.js\";import\"../renderers/support/jsonUtils.js\";import{rendererTypes as t,webSceneRendererTypes as i}from\"../renderers/support/types.js\";import{MultiOriginJSONMixin as o}from\"../core/MultiOriginJSONSupport.js\";import{property as s}from\"../core/accessorSupport/decorators/property.js\";import\"../core/arrayUtils.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../core/accessorSupport/decorators/subclass.js\";import{featureGeometryTypeKebabDictionary as p}from\"../geometry/support/typeUtils.js\";import l from\"./Layer.js\";import{OGCFeatureSource as a}from\"./graphics/sources/OGCFeatureSource.js\";import{APIKeyMixin as d}from\"./mixins/APIKeyMixin.js\";import{BlendLayer as y}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as m}from\"./mixins/CustomParametersMixin.js\";import{FeatureEffectLayer as u}from\"./mixins/FeatureEffectLayer.js\";import{OperationalLayer as f}from\"./mixins/OperationalLayer.js\";import{OrderedLayer as c}from\"./mixins/OrderedLayer.js\";import{PortalLayer as h}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as j}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as g}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as v}from\"./mixins/TemporalLayer.js\";import{elevationInfo as I,labelsVisible as b,legendEnabled as x,popupEnabled as S,screenSizePerspectiveEnabled as F,url as R}from\"./support/commonProperties.js\";import{featureReductionProperty as L}from\"./support/featureReductionUtils.js\";import O from\"./support/FeatureType.js\";import T from\"./support/Field.js\";import{defineFieldProperties as w}from\"./support/fieldProperties.js\";import{fixRendererFields as D,fixTimeInfoFields as P}from\"./support/fieldUtils.js\";import E from\"./support/LabelClass.js\";import{reader as C}from\"./support/labelingInfo.js\";import U from\"../rest/support/Query.js\";import{createPopupTemplate as _}from\"../support/popupUtils.js\";import G from\"../geometry/Extent.js\";import q from\"../geometry/SpatialReference.js\";const B=w();let V=class extends(d(m(u(y(c(v(g(f(h(j(o(l)))))))))))){constructor(e){super(e),this.collectionId=null,this.copyright=null,this.definitionExpression=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType=\"OGCFeatureLayer\",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new a({layer:this}),this.spatialReference=null,this.title=null,this.type=\"ogc-feature\",this.typeIdField=null,this.types=null,this.url=null}destroy(){this.source?.destroy()}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"OGCFeatureServer\"]},e).then((()=>this._fetchService(e)))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&null==this.geometryType}set renderer(e){D(e,this.fieldsIndex),this._set(\"renderer\",e)}on(e,r){return super.on(e,r)}createPopupTemplate(e){return _(this,e)}createQuery(){return new U}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){let t,i=!1;const o=r?.feature?.attributes,s=this.typeIdField&&o?.[this.typeIdField];return null!=s&&this.types&&(i=this.types.some((r=>r.id==s&&(t=r.domains?.[e],\"inherited\"===t?.type&&(t=this._getLayerDomain(e)),!0)))),i||t||(t=this._getLayerDomain(e)),t}queryFeatures(e,r){return this.load().then((()=>this.source.queryFeatures(U.from(e)||this.createQuery(),r))).then((e=>(e?.features?.forEach((e=>{e.layer=e.sourceLayer=this})),e)))}serviceSupportsSpatialReference(e){return this.source?.serviceSupportsSpatialReference(e)??!1}async _fetchService(e){await this.source.load(e),this.read(this.source.featureDefinition,{origin:\"service\"}),D(this.renderer,this.fieldsIndex),P(this.timeInfo,this.fieldsIndex)}_getLayerDomain(e){if(!this.fields)return null;for(const r of this.fields)if(r.name===e&&r.domain)return r.domain;return null}};e([s({readOnly:!0,json:{origins:{service:{read:!0}}}})],V.prototype,\"capabilities\",void 0),e([s({type:String,json:{write:!0}})],V.prototype,\"collectionId\",void 0),e([s({type:String})],V.prototype,\"copyright\",void 0),e([s({readOnly:!0})],V.prototype,\"defaultPopupTemplate\",null),e([s({type:String})],V.prototype,\"definitionExpression\",void 0),e([s({readOnly:!0,type:String,json:{origins:{service:{name:\"collection.description\"}}}})],V.prototype,\"description\",void 0),e([s({type:String})],V.prototype,\"displayField\",void 0),e([s(I)],V.prototype,\"elevationInfo\",void 0),e([s(L)],V.prototype,\"featureReduction\",void 0),e([s({type:[T],json:{origins:{service:{name:\"layerDefinition.fields\"}}}})],V.prototype,\"fields\",void 0),e([s(B.fieldsIndex)],V.prototype,\"fieldsIndex\",void 0),e([s({readOnly:!0,type:G,json:{origins:{service:{name:\"layerDefinition.extent\"}}}})],V.prototype,\"fullExtent\",void 0),e([s({type:p.apiValues,json:{origins:{service:{name:\"layerDefinition.geometryType\",read:{reader:p.read}}}}})],V.prototype,\"geometryType\",void 0),e([s({type:Boolean,json:{origins:{service:{name:\"layerDefinition.hasZ\"}}}})],V.prototype,\"hasZ\",void 0),e([s({type:Boolean,readOnly:!0})],V.prototype,\"isTable\",null),e([s({type:[E],json:{origins:{\"web-document\":{name:\"layerDefinition.drawingInfo.labelingInfo\",read:{reader:C},write:!0}}}})],V.prototype,\"labelingInfo\",void 0),e([s(b)],V.prototype,\"labelsVisible\",void 0),e([s(x)],V.prototype,\"legendEnabled\",void 0),e([s({type:String,json:{origins:{service:{name:\"layerDefinition.objectIdField\"}}}})],V.prototype,\"objectIdField\",void 0),e([s({type:[\"OGCFeatureLayer\"]})],V.prototype,\"operationalLayerType\",void 0),e([s(S)],V.prototype,\"popupEnabled\",void 0),e([s({type:r,json:{name:\"popupInfo\",write:!0}})],V.prototype,\"popupTemplate\",void 0),e([s({types:t,json:{origins:{service:{name:\"layerDefinition.drawingInfo.renderer\",write:!1},\"web-scene\":{types:i,name:\"layerDefinition.drawingInfo.renderer\",write:!0}},name:\"layerDefinition.drawingInfo.renderer\",write:!0}})],V.prototype,\"renderer\",null),e([s(F)],V.prototype,\"screenSizePerspectiveEnabled\",void 0),e([s({readOnly:!0})],V.prototype,\"source\",void 0),e([s({readOnly:!0,type:q,json:{origins:{service:{read:!0}}}})],V.prototype,\"spatialReference\",void 0),e([s({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:\"collection.title\"}}}})],V.prototype,\"title\",void 0),e([s({readOnly:!0,json:{read:!1}})],V.prototype,\"type\",void 0),e([s({type:String,readOnly:!0})],V.prototype,\"typeIdField\",void 0),e([s({type:[O]})],V.prototype,\"types\",void 0),e([s(R)],V.prototype,\"url\",void 0),V=e([n(\"esri.layers.OGCFeatureLayer\")],V);const M=V;export{M as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as s}from\"../../../../core/lang.js\";import{queryCapabilities as e}from\"../../data/QueryEngineCapabilities.js\";import{defaultPointSymbolJSON as r,defaultPolylineSymbolJSON as p,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function u(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?r:\"esriGeometryPolyline\"===t?p:o}}}const n=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let i=1;function a(s,e){if(t(\"esri-csp-restrictions\"))return()=>({[e]:null,...s});try{let t=`this.${e} = null;`;for(const e in s){t+=`this${n.test(e)?`.${e}`:`[\"${e}\"]`} = ${JSON.stringify(s[e])};`}const r=new Function(`\\n      return class AttributesClass$${i++} {\\n        constructor() {\\n          ${t};\\n        }\\n      }\\n    `)();return()=>new r}catch(r){return()=>({[e]:null,...s})}}function l(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:s(t)}}]}function c(t,s){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:s,supportsDelete:s,supportsEditing:s,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:s,supportsExceedsLimitStatistics:!0},query:e,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:s,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}export{c as createCapabilities,a as createDefaultAttributesFunction,l as createDefaultTemplate,u as createDrawingInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nconst t={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};export{t as queryCapabilities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import{OptimizedFeature as t}from\"../../OptimizedFeature.js\";import n from\"../../OptimizedGeometry.js\";import{isNumericField as o}from\"../../../support/fieldUtils.js\";const r={LineString:\"esriGeometryPolyline\",MultiLineString:\"esriGeometryPolyline\",MultiPoint:\"esriGeometryMultipoint\",Point:\"esriGeometryPoint\",Polygon:\"esriGeometryPolygon\",MultiPolygon:\"esriGeometryPolygon\"};function i(e){return r[e]}function*s(e){switch(e.type){case\"Feature\":yield e;break;case\"FeatureCollection\":for(const t of e.features)t&&(yield t)}}function*c(e){if(!e)return null;switch(e.type){case\"Point\":yield e.coordinates;break;case\"LineString\":case\"MultiPoint\":yield*e.coordinates;break;case\"MultiLineString\":case\"Polygon\":for(const t of e.coordinates)yield*t;break;case\"MultiPolygon\":for(const t of e.coordinates)for(const e of t)yield*e}}function*u(e,o={}){const{geometryType:r,objectIdField:s}=o;for(const c of e){const{geometry:e,properties:u,id:l}=c;if(e&&i(e.type)!==r)continue;const f=u||{};let a=f[s]??null;s&&null!=l&&!f[s]&&(f[s]=a=l);const y=new t(e?d(new n,e,o):null,f,null,a);yield y}}function l(e){for(const t of e)if(t.length>2)return!0;return!1}function f(e){return!y(e)}function a(e){return y(e)}function y(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],r=e[(n+1)%e.length];t+=o[0]*r[1]-r[0]*o[1]}return t<=0}function p(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function d(e,t,n){switch(t.type){case\"LineString\":return g(e,t,n);case\"MultiLineString\":return m(e,t,n);case\"MultiPoint\":return h(e,t,n);case\"MultiPolygon\":return w(e,t,n);case\"Point\":return P(e,t,n);case\"Polygon\":return b(e,t,n)}}function g(e,t,n){return F(e,t.coordinates,n),e}function m(e,t,n){for(const o of t.coordinates)F(e,o,n);return e}function h(e,t,n){return F(e,t.coordinates,n),e}function w(e,t,n){for(const o of t.coordinates){j(e,o[0],n);for(let t=1;t<o.length;t++)S(e,o[t],n)}return e}function P(e,t,n){return M(e,t.coordinates,n),e}function b(e,t,n){const o=t.coordinates;j(e,o[0],n);for(let r=1;r<o.length;r++)S(e,o[r],n);return e}function j(e,t,n){const o=p(t);f(o)?G(e,o,n):F(e,o,n)}function S(e,t,n){const o=p(t);a(o)?G(e,o,n):F(e,o,n)}function F(e,t,n){for(const o of t)M(e,o,n);e.lengths.push(t.length)}function G(e,t,n){for(let o=t.length-1;o>=0;o--)M(e,t[o],n);e.lengths.push(t.length)}function M(e,t,n){const[o,r,i]=t;e.coords.push(o,r),n.hasZ&&e.coords.push(i||0)}function k(e){switch(typeof e){case\"string\":return\"esriFieldTypeString\";case\"number\":return\"esriFieldTypeDouble\";default:return\"unknown\"}}function O(t){if(!t)throw new e(\"geojson-layer:empty\",\"GeoJSON data is empty\");if(\"Feature\"!==t.type&&\"FeatureCollection\"!==t.type)throw new e(\"geojson-layer:unsupported-geojson-object\",\"missing or not supported GeoJSON object type\",{data:t});const{crs:n}=t;if(!n)return;const o=\"string\"==typeof n?n:\"name\"===n.type?n.properties.name:\"EPSG\"===n.type?n.properties.code:null,r=new RegExp(\".*(CRS84H?|4326)$\",\"i\");if(!o||!r.test(o))throw new e(\"geojson-layer:unsupported-crs\",\"unsupported GeoJSON 'crs' member\",{crs:n})}function T(e,t={}){const n=[],r=new Set,u=new Set;let f,a=!1,y=null,p=!1,{geometryType:d=null}=t,g=!1;for(const o of s(e)){const{geometry:e,properties:t,id:s}=o;if(!e||(d||(d=i(e.type)),i(e.type)===d)){if(!a){a=l(c(e))}if(p||(p=null!=s,p&&(f=typeof s,y=Object.keys(t).filter((e=>t[e]===s)))),p&&null!=s&&(y.length>1?y=y.filter((e=>t[e]===s)):1===y.length&&(y=t[y[0]]===s?y:[])),!g&&t){let e=!0;for(const o in t){if(r.has(o))continue;const i=t[o];if(null==i){e=!1,u.add(o);continue}const s=k(i);\"unknown\"!==s?(u.delete(o),r.add(o),n.push({name:o,alias:o,type:s})):u.add(o)}g=e}}}const m=y&&1===y.length&&y[0]||null;if(m)for(const i of n)if(i.name===m&&o(i)){i.type=\"esriFieldTypeOID\";break}return{fields:n,geometryType:d,hasZ:a,objectIdFieldName:m,objectIdFieldType:f,unknownFields:Array.from(u)}}function L(e,t){return Array.from(u(s(e),t))}export{L as createOptimizedFeatures,i as getGeometryType,T as inferLayerProperties,O as validateGeoJSON};\n","import _typeof from \"./typeof.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport inherits from \"./inherits.js\";\nexport default function _wrapRegExp() {\n  _wrapRegExp = function _wrapRegExp(re, groups) {\n    return new BabelRegExp(re, void 0, groups);\n  };\n\n  var _super = RegExp.prototype,\n      _groups = new WeakMap();\n\n  function BabelRegExp(re, flags, groups) {\n    var _this = new RegExp(re, flags);\n\n    return _groups.set(_this, groups || _groups.get(re)), setPrototypeOf(_this, BabelRegExp.prototype);\n  }\n\n  function buildGroups(result, re) {\n    var g = _groups.get(re);\n\n    return Object.keys(g).reduce(function (groups, name) {\n      return groups[name] = result[g[name]], groups;\n    }, Object.create(null));\n  }\n\n  return inherits(BabelRegExp, RegExp), BabelRegExp.prototype.exec = function (str) {\n    var result = _super.exec.call(this, str);\n\n    return result && (result.groups = buildGroups(result, this)), result;\n  }, BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n    if (\"string\" == typeof substitution) {\n      var groups = _groups.get(this);\n\n      return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n        return \"$\" + groups[name];\n      }));\n    }\n\n    if (\"function\" == typeof substitution) {\n      var _this = this;\n\n      return _super[Symbol.replace].call(this, str, function () {\n        var args = arguments;\n        return \"object\" != _typeof(args[args.length - 1]) && (args = [].slice.call(args)).push(buildGroups(args, _this)), substitution.apply(this, args);\n      });\n    }\n\n    return _super[Symbol.replace].call(this, str, substitution);\n  }, _wrapRegExp.apply(this, arguments);\n}","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import e from\"../../request.js\";import t from\"../../core/Error.js\";import i from\"../../core/Logger.js\";import{isNone as n,unwrapOr as r,isSome as a}from\"../../core/maybe.js\";import{WGS84 as s}from\"../../geometry/support/spatialReferenceUtils.js\";import{project as o}from\"../../geometry/support/webMercatorUtils.js\";import{convertToFeatureSet as l,convertToGeometry as c,convertFromGeometry as d}from\"../graphics/featureConversionUtils.js\";import u from\"../graphics/OptimizedFeatureSet.js\";import{validateGeoJSON as p,inferLayerProperties as m,createOptimizedFeatures as f}from\"../graphics/sources/geojson/geojson.js\";import{createDrawingInfo as g}from\"../graphics/sources/support/clientSideDefaults.js\";import y from\"../support/FieldsIndex.js\";import{kebabDict as w}from\"../support/fieldType.js\";import h from\"../../geometry/SpatialReference.js\";const b=i.getLogger(\"esri.layers.graphics.sources.ogcfeature\"),j=\"http://www.opengis.net/def/crs/\",F=`${j}OGC/1.3/CRS84`;async function I(i,r,a={},s=5){const{links:o}=i,l=G(o,\"items\",\"application/geo+json\")||G(o,\"http://www.opengis.net/def/rel/ogc/1.0/items\",\"application/geo+json\");if(n(l))throw new t(\"ogc-feature-layer:missing-items-page\",\"Missing items url\");const{data:c}=await e(l.href,{signal:a.signal,query:{limit:s,...a.customParameters,token:a.apiKey},headers:{accept:\"application/geo+json\"}});await p(c);const d=m(c,{geometryType:r.geometryType}),u=r.fields||d.fields||[],f=null!=r.hasZ?r.hasZ:d.hasZ,h=d.geometryType,j=r.objectIdField||d.objectIdFieldName||\"OBJECTID\";let F=r.timeInfo;const I=u.find((e=>e.name===j));if(!I){if(!d.objectIdFieldType)throw new t(\"ogc-feature-layer:missing-feature-id\",\"Collection geojson require a feature id as a unique identifier\");u.unshift({name:j,alias:j,type:\"esriFieldTypeOID\",editable:!1,nullable:!1})}else I.type=\"esriFieldTypeOID\",I.editable=!1,I.nullable=!1;if(j!==d.objectIdFieldName){const e=u.find((e=>e.name===d.objectIdFieldName));e&&(e.type=\"esriFieldTypeInteger\")}u===d.fields&&d.unknownFields.length>0&&b.warn({name:\"ogc-feature-layer:unknown-field-types\",message:\"Some fields types couldn't be inferred from the features and were dropped\",details:{unknownFields:d.unknownFields}});for(const e of u){if(null==e.name&&(e.name=e.alias),null==e.alias&&(e.alias=e.name),\"esriFieldTypeOID\"!==e.type&&\"esriFieldTypeGlobalID\"!==e.type&&(e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable),!e.name)throw new t(\"ogc-feature-layer:invalid-field-name\",\"field name is missing\",{field:e});if(!w.jsonValues.includes(e.type))throw new t(\"ogc-feature-layer:invalid-field-type\",`invalid type for field \"${e.name}\"`,{field:e})}if(F){const e=new y(u);if(F.startTimeField){const t=e.get(F.startTimeField);t?(F.startTimeField=t.name,t.type=\"esriFieldTypeDate\"):F.startTimeField=null}if(F.endTimeField){const t=e.get(F.endTimeField);t?(F.endTimeField=t.name,t.type=\"esriFieldTypeDate\"):F.endTimeField=null}if(F.trackIdField){const t=e.get(F.trackIdField);t?F.trackIdField=t.name:(F.trackIdField=null,b.warn({name:\"ogc-feature-layer:invalid-timeInfo-trackIdField\",message:\"trackIdField is missing\",details:{timeInfo:F}}))}F.startTimeField||F.endTimeField||(b.warn({name:\"ogc-feature-layer:invalid-timeInfo\",message:\"startTimeField and endTimeField are missing\",details:{timeInfo:F}}),F=null)}return{drawingInfo:h?g(h):null,geometryType:h,fields:u,hasZ:!!f,objectIdField:j,timeInfo:F}}async function T(i,r={}){const{links:a}=i,s=G(a,\"data\",\"application/json\")||G(a,\"http://www.opengis.net/def/rel/ogc/1.0/data\",\"application/json\");if(n(s))throw new t(\"ogc-feature-layer:missing-collections-page\",\"Missing collections url\");const{apiKey:o,customParameters:l,signal:c}=r,{data:d}=await e(s.href,{signal:c,headers:{accept:\"application/json\"},query:{...l,token:o}});return d}async function k(i,r={}){const{links:a}=i,s=G(a,\"conformance\",\"application/json\")||G(a,\"http://www.opengis.net/def/rel/ogc/1.0/conformance\",\"application/json\");if(n(s))throw new t(\"ogc-feature-layer:missing-conformance-page\",\"Missing conformance url\");const{apiKey:o,customParameters:l,signal:c}=r,{data:d}=await e(s.href,{signal:c,headers:{accept:\"application/json\"},query:{...l,token:o}});return d}async function S(t,i={}){const{apiKey:n,customParameters:r,signal:a}=i,{data:s}=await e(t,{signal:a,headers:{accept:\"application/json\"},query:{...r,token:n}});return s}async function x(t,i={}){const r=\"application/vnd.oai.openapi+json;version=3.0\",a=G(t.links,\"service-desc\",r);if(n(a))return b.warn(\"ogc-feature-layer:missing-openapi-page\",\"The OGC API-Features server does not have an OpenAPI page.\"),null;const{apiKey:s,customParameters:o,signal:l}=i,{data:c}=await e(a.href,{signal:l,headers:{accept:r},query:{...o,token:s}});return c}function N(e){const t=/^http:\\/\\/www\\.opengis.net\\/def\\/crs\\/(?<authority>.*)\\/(?<version>.*)\\/(?<code>.*)$/i.exec(e)?.groups;if(!t)return null;const{authority:i,code:n}=t;switch(i.toLowerCase()){case\"ogc\":switch(n.toLowerCase()){case\"crs27\":return h.GCS_NAD_1927.wkid;case\"crs83\":return 4269;case\"crs84\":case\"crs84h\":return h.WGS84.wkid;default:return null}case\"esri\":case\"epsg\":{const e=Number.parseInt(n,10);return Number.isNaN(e)?null:e}default:return null}}async function q(e,t,i){const n=await v(e,t,i);return l(n)}async function v(i,l,p){const{capabilities:{query:{maxRecordCount:m}},collection:g,layerDefinition:y,queryParameters:{apiKey:w,customParameters:b},spatialReference:j,supportedCrs:F}=i,{links:I}=g,T=G(I,\"items\",\"application/geo+json\")||G(I,\"http://www.opengis.net/def/rel/ogc/1.0/items\",\"application/geo+json\");if(n(T))throw new t(\"ogc-feature-layer:missing-items-page\",\"Missing items url\");const{geometry:k,num:S,start:x,timeExtent:N,where:q}=l;if(l.objectIds)throw new t(\"ogc-feature-layer:query-by-objectids-not-supported\",\"Queries with objectids are not supported\");const v=h.fromJSON(j),M=r(l.outSpatialReference,v),C=M.isWGS84?null:O(M,F),P=D(k,F),W=R(N),Z=$(q),K=S??(null!=x&&void 0!==x?10:m),{data:L}=await e(T.href,{...p,query:{...b,...P,crs:C,datetime:W,query:Z,limit:K,startindex:x,token:w},headers:{accept:\"application/geo+json\"}});let A=!1;if(L.links){const e=L.links.find((e=>\"next\"===e.rel));A=!!e}!A&&Number.isInteger(L.numberMatched)&&Number.isInteger(L.numberReturned)&&(A=L.numberReturned<L.numberMatched);const{fields:E,globalIdField:J,hasM:U,hasZ:_,objectIdField:z}=y,B=y.geometryType,Q=f(L,{geometryType:B,hasZ:_,objectIdField:z});if(!C&&M.isWebMercator)for(const e of Q)if(a(e.geometry)){const t=c(e.geometry,B,_,!1);t.spatialReference=h.WGS84,e.geometry=d(o(t,M))}for(const e of Q)e.objectId=e.attributes[z];const V=C||!C&&M.isWebMercator?M.toJSON():s,H=new u;return H.exceededTransferLimit=A,H.features=Q,H.fields=E,H.geometryType=B,H.globalIdFieldName=J,H.hasM=U,H.hasZ=_,H.objectIdFieldName=z,H.spatialReference=V,H}function M(e){return a(e)&&\"extent\"===e.type}function O(e,t){const{isWebMercator:i,wkid:n}=e;if(!n)return null;const r=i?t[3857]??t[102100]??t[102113]??t[900913]:t[e.wkid];return r?`${j}${r}`:null}function C(e){if(n(e))return\"\";const{xmin:t,ymin:i,xmax:r,ymax:a}=e;return`${t},${i},${r},${a}`}function R(e){if(n(e))return null;const{start:t,end:i}=e;return`${a(t)?t.toISOString():\"..\"}/${a(i)?i.toISOString():\"..\"}`}function $(e){return n(e)||!e||\"1=1\"===e?null:e}function D(e,t){if(!M(e))return null;const{spatialReference:i}=e;if(!i||i.isWGS84)return{bbox:C(e)};const n=O(i,t);return a(n)?{bbox:C(e),\"bbox-crs\":n}:i.isWebMercator?{bbox:C(o(e,h.WGS84))}:null}function G(e,t,i){return e.find((e=>e.rel===t&&e.type===i))||e.find((e=>e.rel===t&&!e.type))}export{F as crsDefault,j as crsPrefix,I as getCollectionDefinition,T as getServerCollections,k as getServerConformance,S as getServerLandingPage,x as getServerOpenApi,N as getSpatialReferenceWkid,q as queryFeatureSetJSON,v as queryOptimizedFeatureSet};\n"],"sourceRoot":""}