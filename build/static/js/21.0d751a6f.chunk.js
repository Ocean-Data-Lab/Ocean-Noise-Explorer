(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[21],{1196:function(e,r,t){"use strict";t.r(r),t.d(r,"fetchFeatureService",(function(){return S})),t.d(r,"fromUrl",(function(){return d}));var n=t(5),a=t(155),u=t(154),c=t.n(u),s=t(186),i=t(159),o=t(146),l=t(183),p=t(372),f=t(580);function d(e){return b.apply(this,arguments)}function b(){return(b=Object(a.a)(c.a.mark((function e(r){var a,u,s,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=null===(a=r.properties)||void 0===a?void 0:a.customParameters,e.next=3,v(r.url,u);case 3:if(s=e.sent,i=Object(n.a)(Object(n.a)({},r.properties),{},{url:r.url}),s.sublayerIds){e.next=7;break}return e.abrupt("return",(null!=s.layerOrTableId&&(i.layerId=s.layerOrTableId,i.sourceJSON=s.sourceJSON),new s.Constructor(i)));case 7:return e.next=10,t.e(44).then(t.bind(null,879));case 10:return e.t0=e.sent.default,e.t1={title:s.parsedUrl.title},o=new e.t0(e.t1),e.abrupt("return",(h(o,s,i),o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,r){return e?e.find((function(e){return e.id===r})):null}function h(e,r,t){function a(e,a){var u=Object(n.a)(Object(n.a)({},t),{},{layerId:e,sublayerTitleMode:"service-name"});return Object(o.k)(a)&&(u.sourceJSON=a),new r.Constructor(u)}r.sublayerIds.forEach((function(t){var n=a(t,y(r.sublayerInfos,t));e.add(n)})),r.tableIds.forEach((function(t){var n=a(t,y(r.tableInfos,t));e.tables.add(n)}))}function v(e,r){return x.apply(this,arguments)}function x(){return x=Object(a.a)(c.a.mark((function e(r,t){var n,a,u,s,l,f,d,b,y,h,v,x,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(p.f)(r),e.t0=Object(o.j)(n),!e.t0){e.next=6;break}return e.next=5,w(r,t);case 5:n=e.sent;case 6:if(!Object(o.j)(n)){e.next=8;break}throw new i.a("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:r});case 8:u=(a=n).serverType,s=a.sublayer,f={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},e.t1=u,e.next="MapServer"===e.t1?13:"ImageServer"===e.t1?15:"SceneServer"===e.t1?17:19;break;case 13:return l=null!=s?"FeatureLayer":g(r,t).then((function(e){return e?"TileLayer":"MapImageLayer"})),e.abrupt("break",20);case 15:return l=C(r,{customParameters:t}).then((function(e){var r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?"LERC"!==(null===r||void 0===r?void 0:r.toUpperCase())||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"})),e.abrupt("break",20);case 17:return l=C(n.url.path,{customParameters:t}).then((function(e){if(e){if("Voxel"===(null===e||void 0===e?void 0:e.layerType))return"VoxelLayer";if(null!==e&&void 0!==e&&e.layers&&Array.isArray(e.layers)&&e.layers.length>0){var r,t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},n=null===(r=e.layers[0])||void 0===r?void 0:r.layerType;if(null!=t[n])return t[n]}}return"SceneLayer"})),e.abrupt("break",20);case 19:l=f[u];case 20:return d={FeatureLayer:!0,SceneLayer:!0},y={parsedUrl:n,Constructor:null,layerOrTableId:(b="FeatureServer"===u)?s:null,sublayerIds:null,tableIds:null},e.next=25,l;case 25:if(h=e.sent,!d[h]||null!=s){e.next=32;break}return e.next=29,j(r,u,t);case 29:m=e.sent,b&&(y.sublayerInfos=m.layerInfos,y.tableInfos=m.tableInfos),1!==m.layerIds.length+m.tableIds.length?(y.sublayerIds=m.layerIds,y.tableIds=m.tableIds):b&&(y.layerOrTableId=null!==(v=m.layerIds[0])&&void 0!==v?v:m.tableIds[0],y.sourceJSON=null!==(x=m.layerInfos[0])&&void 0!==x?x:m.tableInfos[0]);case 32:return e.next=34,P(h);case 34:return y.Constructor=e.sent,e.abrupt("return",y);case 36:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function w(e,r){return m.apply(this,arguments)}function m(){return m=Object(a.a)(c.a.mark((function e(r,t){var n,a,u,s,i,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(r,{customParameters:t});case 2:if(a=e.sent,u=null,s=null,"Feature Layer"===(i=a.type)||"Table"===i?(u="FeatureServer",s=a.id):"indexedVector"===i?u="VectorTileServer":a.hasOwnProperty("mapName")?u="MapServer":a.hasOwnProperty("bandCount")&&a.hasOwnProperty("pixelSizeX")?u="ImageServer":a.hasOwnProperty("maxRecordCount")&&a.hasOwnProperty("allowGeometryUpdates")?u="FeatureServer":a.hasOwnProperty("streamUrls")?u="StreamServer":O(a)?(u="SceneServer",s=a.id):a.hasOwnProperty("layers")&&O(null===(n=a.layers)||void 0===n?void 0:n[0])&&(u="SceneServer"),u){e.next=7;break}return e.abrupt("return",null);case 7:return f=null!=s?Object(p.g)(r):null,e.abrupt("return",{title:Object(o.k)(f)&&a.name||Object(l.m)(r),serverType:u,sublayer:s,url:{path:Object(o.k)(f)?f.serviceUrl:Object(l.M)(r).path}});case 9:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function O(e){return(null===e||void 0===e?void 0:e.hasOwnProperty("store"))&&e.hasOwnProperty("id")&&"number"==typeof e.id}function j(e,r,t){return k.apply(this,arguments)}function k(){return(k=Object(a.a)(c.a.mark((function e(r,t,n){var a,u,s,i,o,l,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!1,"FeatureServer"!==t){e.next=8;break}return e.next=4,S(r,{customParameters:n});case 4:o=e.sent,i=!!o.layersJSON,s=o.layersJSON||o.serviceJSON,e.next=11;break;case 8:return e.next=10,C(r,{customParameters:n});case 10:s=e.sent;case 11:return l=null===(a=s)||void 0===a?void 0:a.layers,p=null===(u=s)||void 0===u?void 0:u.tables,e.abrupt("return",{layerIds:(null===l||void 0===l?void 0:l.map((function(e){return e.id})).reverse())||[],tableIds:(null===p||void 0===p?void 0:p.map((function(e){return e.id})).reverse())||[],layerInfos:i?l:[],tableInfos:i?p:[]});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return!e.type||"Feature Layer"===e.type}function S(e,r){return I.apply(this,arguments)}function I(){return(I=Object(a.a)(c.a.mark((function e(r,t){var n,a,u,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(r,t);case 2:if((u=(u=e.sent)||{}).layers=(null===(n=u.layers)||void 0===n?void 0:n.filter(L))||[],s={serviceJSON:u},!(u.currentVersion<10.5)){e.next=7;break}return e.abrupt("return",s);case 7:return e.next=9,C(r+"/layers",t);case 9:return i=e.sent,e.abrupt("return",(s.layersJSON={layers:(null===i||void 0===i||null===(a=i.layers)||void 0===a?void 0:a.filter(L))||[],tables:(null===i||void 0===i?void 0:i.tables)||[]},s));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return T.apply(this,arguments)}function T(){return(T=Object(a.a)(c.a.mark((function e(r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.a[r])());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,r){return M.apply(this,arguments)}function M(){return(M=Object(a.a)(c.a.mark((function e(r,t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(r,{customParameters:t});case 2:return e.abrupt("return",e.sent.tileInfo);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,r){return F.apply(this,arguments)}function F(){return(F=Object(a.a)(c.a.mark((function e(r,t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.default)(r,{responseType:"json",query:Object(n.a)(Object(n.a)({f:"json"},null===t||void 0===t?void 0:t.customParameters),{},{token:null===t||void 0===t?void 0:t.apiKey})});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},580:function(e,r,t){"use strict";t.d(r,"a",(function(){return c}));var n=t(155),a=t(154),u=t.n(a),c={BingMapsLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(180).then(t.bind(null,1084));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),BuildingSceneLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(12),t.e(94)]).then(t.bind(null,1063));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),CSVLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(109).then(t.bind(null,1085));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ElevationLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(37).then(t.bind(null,1073));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),FeatureLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(t.bind(null,404));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),GroupLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(44).then(t.bind(null,879));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),GeoRSSLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(181).then(t.bind(null,1028));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),GeoJSONLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(110).then(t.bind(null,1086));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ImageryLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(2),t.e(18),t.e(30),t.e(111)]).then(t.bind(null,1061));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ImageryTileLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(2),t.e(18),t.e(30),t.e(36),t.e(95)]).then(t.bind(null,1064));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(12),t.e(106)]).then(t.bind(null,1074));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),KMLLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(120).then(t.bind(null,1087));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),LineOfSightLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(115).then(t.bind(null,1068));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),MapImageLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(38),t.e(92)]).then(t.bind(null,1033));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),MapNotesLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(121).then(t.bind(null,1088));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),OGCFeatureLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(83).then(t.bind(null,1089));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(112).then(t.bind(null,1036));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),PointCloudLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(12),t.e(89)]).then(t.bind(null,1066));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),RouteLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(72).then(t.bind(null,1062));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),SceneLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(12),t.e(88)]).then(t.bind(null,1071));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),StreamLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(182).then(t.bind(null,1090));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),TileLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(38),t.e(96)]).then(t.bind(null,1037));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),UnknownLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(183).then(t.bind(null,1038));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),UnsupportedLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(184).then(t.bind(null,1039));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),VectorTileLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(33),t.e(75)]).then(t.bind(null,1065));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),VoxelLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(12),t.e(185)]).then(t.bind(null,1060));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),WebTileLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(122).then(t.bind(null,591));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),WFSLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(80).then(t.bind(null,1091));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),WMSLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(93).then(t.bind(null,1075));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),WMTSLayer:function(){var e=Object(n.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.e(90).then(t.bind(null,1069));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}}]);